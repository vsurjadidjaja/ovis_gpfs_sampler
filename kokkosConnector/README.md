# LDMS-Kokkos Connector

The kokkosConnector and Kokkos Sampler utilizes LDMS Streams to collect kernel messages generated by the Sampler and received by the Connector.

The LDMS-Kokkos Connector relies on LDMS Streams to publish data to your provided database. Please refer to the following on how to setup LDMS Streams: https://ovis-hpcreadthedocs.readthedocs.io/en/latest/ldms-streams.html

The following libraries are needed for the kokkosConnector:
* Kokkos-Tools: https://github.com/kokkos/kokkos-tools

To install the appropriate utitilies in Kokkos-Tools for the Kokkos sampler:
* Navigate to kokkos-tools/common/kokkos-sampler/
* Follow the appropriate make instructions in Kokkos-Tools to make the kokkos-sampler with its included Makefile.

The following information will need to be added to the kokkosConnector's Makefile before running make:
* Path to Ovis needs to be set for OVIS_DIR in the Makefile
* Path to Kokkos-Tools needs to be set of KOKKOS_DIR in the Makefile

When using the KokkosConnector and its sampler, the following environmental variables are required to be set prior to application execution command:
  * KOKKOS_LDMS_HOST="localhost"
  * KOKKOS_LDMS_PORT="412"
  * KOKKOS_TOOLS_LIB="[INSERT PATH TO KOKKOS-TOOLS]/kokkos-tools/common/kokkos-sampler/kp_sampler.so;[INSERT PATH TO OVIS]/kokkosConnector/kp_kernel_ldms.so"
  * KOKKOS_LDMS_AUTH="munge"
  * KOKKOS_LDMS_XPRT="sock"

The following environmental variables are optional to set:
* KOKKOS_TOOLS_SAMPLER_SKIP
  * This variable is responsible for setting the kernel sampling rate done by the Kokkos Sampler. By default, KOKKOS_TOOLS_SAMPLER_SKIP is set to 1 (which is sampling rate of 100%)
* KOKKOS_LDMS_VERBOSE
  * This variable is for debug purposes and prints all Kokkos messages received by the LDMS-Kokkos Connector to the output file.
* KOKKOS_TOOLS_SAMPLER_VERBOSE
  * This variable is for debug purposes and prints all Kokkos kernel messages received by the Kokkos-Tools Sampler to the output file.
